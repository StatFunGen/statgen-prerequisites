<svg viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="800" height="600" fill="#f8f9fa" />
  
  <!-- Title -->
  <text x="400" y="40" font-family="Arial" font-size="24" text-anchor="middle" font-weight="bold"> Single marker linear regression</text>


  <!-- Single Variant Regression Panel -->
  <rect x="50" y="70" width="700" height="260" fill="white" stroke="#ddd" rx="10" ry="10" />
  <text x="380" y="95" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Single Variant Regression</text>
  <!-- <text x="220" y="110" font-family="Arial" font-size="14" text-anchor="middle" font-style="italic">y = X<tspan baseline-shift="sub" font-size="10">j</tspan>β + ε</text> -->
  
  <!-- Single variant visualization -->
  <g transform="translate(280, 140)">
    <!-- Trait vector -->
    <rect x="0" y="0" width="30" height="120" fill="#FFD700" stroke="#333" stroke-width="2" />
    <text x="15" y="-10" font-family="Arial" font-size="14" text-anchor="middle">Y</text>
    <text x="15" y="140" font-family="Arial" font-size="10" text-anchor="middle">N × 1</text>
    <text x="15" y="155" font-family="Arial" font-size="10" text-anchor="middle">Trait</text>
    
    <!-- Equals symbol -->
    <text x="45" y="60" font-family="Arial" font-size="18" text-anchor="middle">=</text>
    
    <!-- SNP vector -->
    <rect x="60" y="0" width="30" height="120" fill="#99CCFF" stroke="#3366CC" stroke-width="2" />
    <text x="75" y="-10" font-family="Arial" font-size="14" text-anchor="middle">X<tspan baseline-shift="sub" font-size="10">j</tspan></text>
    <text x="75" y="140" font-family="Arial" font-size="10" text-anchor="middle">N × 1</text>
    <text x="75" y="155" font-family="Arial" font-size="10" text-anchor="middle">Genotype</text>
    
    <!-- Beta (coefficient) -->
    <rect x="105" y="50" width="30" height="30" fill="#FF9999" stroke="#CC3333" stroke-width="2" />
    <text x="120" y="-10" font-family="Arial" font-size="14" text-anchor="middle">β</text>
    <text x="120" y="65" font-family="Arial" font-size="14" text-anchor="middle">β</text>
    <text x="120" y="140" font-family="Arial" font-size="10" text-anchor="middle">Effect</text>
    <text x="120" y="155" font-family="Arial" font-size="10" text-anchor="middle">(scalar)</text>
    
    <!-- Plus symbol -->
    <text x="150" y="60" font-family="Arial" font-size="18" text-anchor="middle">+</text>
    
    <!-- Error vector -->
    <rect x="170" y="0" width="30" height="120" fill="#CCCCCC" stroke="#666666" stroke-width="2" />
    <text x="185" y="-10" font-family="Arial" font-size="14" text-anchor="middle">ε</text>
    <text x="185" y="140" font-family="Arial" font-size="10" text-anchor="middle">N × 1</text>
    <text x="185" y="155" font-family="Arial" font-size="10" text-anchor="middle">Error</text>
    
   
  </g>
  <!-- OLS Estimation Panel -->
  <rect x="50" y="350" width="340" height="210" fill="white" stroke="#ddd" rx="10" ry="10" />
  <text x="220" y="375" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Ordinary Least Squares (OLS)</text>
  <text x="220" y="395" font-family="Arial" font-size="14" text-anchor="middle" font-style="italic">β̂<tspan baseline-shift="sub" font-size="10">OLS</tspan> = (X<tspan baseline-shift="sub" font-size="8">j</tspan><tspan baseline-shift="super" font-size="10">T</tspan>X<tspan baseline-shift="sub" font-size="8">j</tspan> )<tspan baseline-shift="super" font-size="10">-1</tspan>X<tspan baseline-shift="sub" font-size="8">j</tspan><tspan baseline-shift="super" font-size="10">T</tspan>Y</text>
  
  <!-- OLS visualization -->
  <g transform="translate(75, 420)">
    <!-- Beta hat -->
    <rect x="0" y="30" width="30" height="30" fill="#FF9999" stroke="#CC3333" stroke-width="2" />
    <text x="15" y="5" font-family="Arial" font-size="14" text-anchor="middle">β̂</text>
    
    <!-- Equals symbol -->
    <text x="45" y="50" font-family="Arial" font-size="18" text-anchor="middle">=</text>
    
    <!-- (X'X)^-1 -->
    <rect x="75" y="30" width="30" height="30" fill="#E6F3FF" stroke="#3366CC" stroke-width="2" />
    <text x="90" y="5" font-family="Arial" font-size="14" text-anchor="middle">(X<tspan baseline-shift="sub" font-size="8">j</tspan><tspan baseline-shift="super" font-size="10">T</tspan>X<tspan baseline-shift="sub" font-size="8">j</tspan>)<tspan baseline-shift="super" font-size="10">-1</tspan></text>
    
    <!-- Multiply symbol -->
    <text x="116" y="50" font-family="Arial" font-size="18" text-anchor="middle">×</text>
    
    <!-- X' -->
    <rect x="125" y="30" width="80" height="30" fill="#99CCFF" stroke="#3366CC" stroke-width="2" />
    <text x="166" y="5" font-family="Arial" font-size="14" text-anchor="middle">X<tspan baseline-shift="sub" font-size="8">j</tspan><tspan baseline-shift="super" font-size="10">T</tspan></text>
    
    <!-- Multiply symbol -->
    <text x="215" y="50" font-family="Arial" font-size="18" text-anchor="middle">×</text>
    
    <!-- Y vector -->
    <rect x="225" y="20" width="30" height="80" fill="#FFD700" stroke="#333" stroke-width="2" />
    <text x="240" y="5" font-family="Arial" font-size="14" text-anchor="middle">Y</text>
    
  </g>
  
  <!-- NEW OLS Scatter Plot and Regression Line Visualization -->
  <rect x="410" y="350" width="340" height="210" fill="white" stroke="#ddd" rx="10" ry="10" />
  <text x="580" y="375" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">OLS Visualization</text>
  <text x="580" y="395" font-family="Arial" font-size="14" text-anchor="middle">Minimizes sum of squared residuals</text>
  
  <!-- Scatter plot visualization -->
  <g transform="translate(440, 405)">
    <!-- Axes -->
    <line x1="0" y1="130" x2="280" y2="130" stroke="#333" stroke-width="2" /> <!-- x-axis -->
    <line x1="0" y1="130" x2="0" y2="0" stroke="#333" stroke-width="2" /> <!-- y-axis -->
    
    <!-- Axis labels -->
    <text x="140" y="145" font-family="Arial" font-size="12" text-anchor="middle">Genotype (X<tspan baseline-shift="sub" font-size="8">j</tspan>)</text>
    <text x="-20" y="75" font-family="Arial" font-size="12" text-anchor="middle" transform="rotate(-90, -20, 65)">Trait (Y)</text>
    
    <!-- Data points -->
    <circle cx="50" cy="90" r="4" fill="#3366CC" />
    <circle cx="50" cy="70" r="4" fill="#3366CC" />
    <circle cx="90" cy="60" r="4" fill="#3366CC" />
    <circle cx="130" cy="50" r="4" fill="#3366CC" />
    <circle cx="170" cy="40" r="4" fill="#3366CC" />
    <circle cx="170" cy="20" r="4" fill="#3366CC" />
    <circle cx="220" cy="30" r="4" fill="#3366CC" />
    <circle cx="220" cy="10" r="4" fill="#3366CC" />
    
    <!-- Regression line -->
    <line x1="0" y1="110" x2="240" y2="5" stroke="#CC3333" stroke-width="2" stroke-dasharray="4,2"/>
    
    <!-- Beta slope annotation -->
    <!-- <path d="M140,130 L180,80" stroke="#333" stroke-width="1" stroke-dasharray="4,2" /> -->
    <!-- <path d="M180,130 L180,80" stroke="#333" stroke-width="1" stroke-dasharray="4,2" /> -->
    <text x="248" y="10" font-family="Arial" font-size="14" fill="#CC3333" font-weight="bold">β̂</text>
  
    
    
    <!-- Information note -->
    <text x="180" y="90" font-family="Arial" font-size="10" fill="#666666" text-anchor="middle">OLS finds β̂ that minimizes</text>
    <text x="185" y="102" font-family="Arial" font-size="10" fill="#666666" text-anchor="middle">the sum of squared residuals</text>
  </g>
</svg>