<svg viewBox="0 0 800 650" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="800" height="650" fill="#f8f9fa" />
  
  <!-- Title -->
  <text x="400" y="40" font-family="Arial" font-size="24" text-anchor="middle" font-weight="bold">Random Effect and Linear Mixed Models</text>
  <text x="400" y="70" font-family="Arial" font-size="16" text-anchor="middle" font-style="italic">Accounts for correlation due to shared genetic background</text>
  
  <!-- Background Boxes -->
  <rect x="50" y="90" width="700" height="180" fill="#f2f2f2" rx="10" ry="10" stroke="#d9d9d9" stroke-width="1" />
  <!-- <rect x="50" y="240" width="700" height="230" fill="#f2f2f2" rx="10" ry="10" stroke="#d9d9d9" stroke-width="1" /> -->
  
  <!-- Section 1: Population of Individuals -->
  <text x="400" y="110" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle">Population with Genetic Variants</text>
  
  <!-- Individual cute figures -->
  <g transform="translate(150, 150)">
     <!-- Family 1 Label -->
  <rect x="-40" y="-30" width="330" height="125" rx="5" ry="5" fill="rgba(231,248,51,0.675)" fill-opacity="0.3"  stroke-width="1" />
  <text x="120" y="83" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Family 1</text>
  
  <!-- Family 2 Label -->
  <rect x="330" y="-30" width="220" height="125" rx="5" ry="5" fill="#99ccff" fill-opacity="0.3"  stroke-width="1" />
  <text x="450" y="83" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Family 2</text>
  
    <!-- Individual 1 - Red -->
    <circle cx="0" cy="0" r="10" fill="#ff9999" stroke="#ff9999" stroke-width="4" />
    <line x1="0" y1="10" x2="0" y2="25" stroke="#ff9999" stroke-width="4" />
    <line x1="0" y1="25" x2="-7" y2="38" stroke="#ff9999" stroke-width="4" />
    <line x1="0" y1="25" x2="7" y2="38" stroke="#ff9999" stroke-width="4" />
    <line x1="0" y1="18" x2="-10" y2="23" stroke="#ff9999" stroke-width="4" />
    <line x1="0" y1="18" x2="10" y2="23" stroke="#ff9999" stroke-width="4" />
    <text x="0" y="55" font-family="Arial" font-size="12" text-anchor="middle">Ind 1</text>
    <circle cx="-4" cy="-2" r="2.5" fill="#000" />
    <circle cx="4" cy="-2" r="2.5" fill="#000" />
    <path d="M-4,5 Q0,8 4,5" stroke="#000" stroke-width="1" fill="none" />
    
    <!-- Individual 2 - Blue -->
    <circle cx="125" cy="0" r="12" fill="#99ccff" stroke="#99ccff" stroke-width="4" />
    <line x1="125" y1="10" x2="125" y2="25" stroke="#99ccff" stroke-width="4" />
    <line x1="125" y1="25" x2="118" y2="38" stroke="#99ccff" stroke-width="4" />
    <line x1="125" y1="25" x2="132" y2="38" stroke="#99ccff" stroke-width="4" />
    <line x1="125" y1="18" x2="115" y2="23" stroke="#99ccff" stroke-width="4" />
    <line x1="125" y1="18" x2="135" y2="23" stroke="#99ccff" stroke-width="4" />
    <text x="125" y="55" font-family="Arial" font-size="12" text-anchor="middle">Ind 2</text>
    <circle cx="121" cy="-2" r="2.5" fill="#000" />
    <circle cx="129" cy="-2" r="2.5" fill="#000" />
    <path d="M121,5 Q125,8 129,5" stroke="#000" stroke-width="1" fill="none" />
    
    <!-- Individual 3 - Green -->
    <circle cx="250" cy="0" r="12" fill="#99ff99" stroke="#99ff99" stroke-width="4" />
    <line x1="250" y1="10" x2="250" y2="25" stroke="#99ff99" stroke-width="4" />
    <line x1="250" y1="25" x2="243" y2="38" stroke="#99ff99" stroke-width="4" />
    <line x1="250" y1="25" x2="257" y2="38" stroke="#99ff99" stroke-width="4" />
    <line x1="250" y1="18" x2="240" y2="23" stroke="#99ff99" stroke-width="4" />
    <line x1="250" y1="18" x2="260" y2="23" stroke="#99ff99" stroke-width="4" />
    <text x="250" y="55" font-family="Arial" font-size="12" text-anchor="middle">Ind 3</text>
    <circle cx="246" cy="-2" r="2.5" fill="#000" />
    <circle cx="254" cy="-2" r="2.5" fill="#000" />
    <path d="M246,5 Q250,8 254,5" stroke="#000" stroke-width="1" fill="none" />
    
    <!-- Individual 4 - Orange -->
    <circle cx="375" cy="0" r="12" fill="#ffcc99" stroke="#ffcc99" stroke-width="4" />
    <line x1="375" y1="10" x2="375" y2="25" stroke="#ffcc99" stroke-width="4" />
    <line x1="375" y1="25" x2="368" y2="38" stroke="#ffcc99" stroke-width="4" />
    <line x1="375" y1="25" x2="382" y2="38" stroke="#ffcc99" stroke-width="4" />
    <line x1="375" y1="18" x2="365" y2="23" stroke="#ffcc99" stroke-width="4" />
    <line x1="375" y1="18" x2="385" y2="23" stroke="#ffcc99" stroke-width="4" />
    <text x="375" y="55" font-family="Arial" font-size="12" text-anchor="middle">Ind 4</text>
    <circle cx="371" cy="-2" r="2.5" fill="#000" />
    <circle cx="379" cy="-2" r="2.5" fill="#000" />
    <path d="M371,5 Q375,8 379,5" stroke="#000" stroke-width="1" fill="none" />
    
    <!-- Individual 5 - Purple -->
    <circle cx="500" cy="0" r="12" fill="#cc99ff" stroke="#cc99ff" stroke-width="4" />
    <line x1="500" y1="10" x2="500" y2="25" stroke="#cc99ff" stroke-width="4" />
    <line x1="500" y1="25" x2="493" y2="38" stroke="#cc99ff" stroke-width="4" />
    <line x1="500" y1="25" x2="507" y2="38" stroke="#cc99ff" stroke-width="4" />
    <line x1="500" y1="18" x2="490" y2="23" stroke="#cc99ff" stroke-width="4" />
    <line x1="500" y1="18" x2="510" y2="23" stroke="#cc99ff" stroke-width="4" />
    <text x="500" y="55" font-family="Arial" font-size="12" text-anchor="middle">Ind 5</text>
    <circle cx="496" cy="-2" r="2.5" fill="#000" />
    <circle cx="504" cy="-2" r="2.5" fill="#000" />
    <path d="M496,5 Q500,8 504,5" stroke="#000" stroke-width="1" fill="none" />
  </g>
  
  
  <!-- Model Formula Section -->
  <rect x="50" y="290" width="700" height="100" rx="10" fill="#e6f3ff" stroke="#2980b9" stroke-width="2" />
  <text x="400" y="315" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Linear Mixed Model Formula</text>
  
  <!-- Main formula -->
  <text x="400" y="350" font-family="Arial" font-size="20" text-anchor="middle" font-style="italic">y = Xβ + Zu + ε</text>
  <text x="400" y="375" font-family="Arial" font-size="14" text-anchor="middle">where u ~ N(0, σ²ᵤK) and ε ~ N(0, σ²ₑI)</text>
  
  <!-- Components Section -->
  <rect x="50" y="420" width="700" height="200" rx="10" fill="#e6ffe6" stroke="#27ae60" stroke-width="2" />
  <text x="400" y="445" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Components Visualization</text>
  
  <!-- Components visualization -->
  <g transform="translate(110, 475)">
    <!-- Phenotype vector -->
    <rect x="0" y="0" width="30" height="100" fill="#FFD700" stroke="#333" stroke-width="2" />
    <text x="15" y="-10" font-family="Arial" font-size="14" text-anchor="middle">Y</text>
    <text x="15" y="115" font-family="Arial" font-size="10" text-anchor="middle">Phenotype</text>
    
    <!-- Equals symbol -->
    <text x="50" y="55" font-family="Arial" font-size="18" text-anchor="middle">=</text>
    
    <!-- Fixed effects -->
    <rect x="70" y="0" width="30" height="100" fill="#99CCFF" stroke="#3366CC" stroke-width="2" />
    <text x="85" y="-10" font-family="Arial" font-size="14" text-anchor="middle">Xβ</text>
    <text x="90" y="115" font-family="Arial" font-size="10" text-anchor="middle">Fixed Effects</text>
    <text x="90" y="125" font-family="Arial" font-size="10" text-anchor="middle">(Variant Effects)</text>
    
    <!-- Plus symbol -->
    <text x="125" y="55" font-family="Arial" font-size="18" text-anchor="middle">+</text>
    
    <!-- Random effects -->
    <rect x="150" y="0" width="30" height="100" fill="#FF9999" stroke="#CC3333" stroke-width="2" />
    <text x="165" y="-10" font-family="Arial" font-size="14" text-anchor="middle">Zu</text>
    <text x="170" y="115" font-family="Arial" font-size="10" text-anchor="middle">Random Effects</text>
    <text x="170" y="125" font-family="Arial" font-size="10" text-anchor="middle">(Family Structure)</text>
    
    <!-- Plus symbol -->
    <text x="205" y="55" font-family="Arial" font-size="18" text-anchor="middle">+</text>
    
    <!-- Error -->
    <rect x="230" y="0" width="30" height="100" fill="#CCCCCC" stroke="#666666" stroke-width="2" />
    <text x="245" y="-10" font-family="Arial" font-size="14" text-anchor="middle">ε</text>
    <text x="245" y="115" font-family="Arial" font-size="10" text-anchor="middle">Residual</text>
    <text x="245" y="125" font-family="Arial" font-size="10" text-anchor="middle">Error</text>
  </g>
  
  <!-- Kinship Matrix -->
  <g transform="translate(470, 490)">
    <rect x="-5" y="-20" width="115" height="115" fill="#FFE6CC" stroke="#E67E22" stroke-width="2" />
    <text x="55" y="-25" font-family="Arial" font-size="18" text-anchor="middle">GRM </text>
    
    <!-- Matrix values -->
    <text x="10" y="0" font-family="Arial" font-size="12" text-anchor="middle">1.0</text>
    <text x="30" y="0" font-family="Arial" font-size="12" text-anchor="middle">0.5</text>
    <text x="50" y="0" font-family="Arial" font-size="12" text-anchor="middle">0.5</text>
    
    <text x="10" y="20" font-family="Arial" font-size="12" text-anchor="middle">0.5</text>
    <text x="30" y="20" font-family="Arial" font-size="12" text-anchor="middle">1.0</text>
    <text x="50" y="20" font-family="Arial" font-size="12" text-anchor="middle">0.5</text>
    
    <text x="10" y="40" font-family="Arial" font-size="12" text-anchor="middle">0.5</text>
    <text x="30" y="40" font-family="Arial" font-size="12" text-anchor="middle">0.5</text>
    <text x="50" y="40" font-family="Arial" font-size="12" text-anchor="middle">1.0</text>

    <text x="75" y="60" font-family="Arial" font-size="12" text-anchor="middle">1.0</text>
    <text x="95" y="60" font-family="Arial" font-size="12" text-anchor="middle">0.5</text>
    
    <text x="75" y="80" font-family="Arial" font-size="12" text-anchor="middle">0.5</text>
    <text x="95" y="80" font-family="Arial" font-size="12" text-anchor="middle">1.0</text>

    <text x="85" y="20" font-family="Arial" font-size="30" text-anchor="middle">0</text>
    <text x="30" y="75" font-family="Arial" font-size="30" text-anchor="middle">0</text>


    <path d="M 120,40 L 140,40" stroke="#333" stroke-width="1.5" marker-end="url(#arrowhead)" />
    <text x="150" y="35" font-family="Arial" font-size="12" text-anchor="start">Captures relatedness</text>
    <text x="153" y="50" font-family="Arial" font-size="12" text-anchor="start">between individuals</text>
  </g>
  
  <!-- Define arrowhead marker -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
  </defs>
  
  <!-- Key advantage -->
  <!-- <rect x="50" y="490" width="700" height="90" rx="10" fill="#f5f5f5" stroke="#7f8c8d" stroke-width="2" />
  <text x="400" y="515" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Random Effect Model: Key Advantage</text>
  <text x="400" y="545" font-family="Arial" font-size="16" text-anchor="middle" font-style="italic">Accounts for correlation due to shared genetic background,</text>
  <text x="400" y="565" font-family="Arial" font-size="16" text-anchor="middle" font-style="italic">preventing overestimation of specific variant effects</text> -->
  
</svg>